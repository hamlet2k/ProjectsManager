<div class="modal fade" id="confirmationModal" tabindex="-1" aria-labelledby="confirmationModalTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-sm">
        <div class="modal-content">
            <div class="modal-header border-0 pb-0">
                <h5 class="modal-title" id="confirmationModalTitle">Confirm action</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p class="mb-0" id="confirmationModalBody">Are you sure you want to continue?</p>
            </div>
            <div class="modal-footer border-0 pt-0">
                <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-danger" id="confirmButton">Confirm</button>
            </div>
        </div>
    </div>
</div>

<script>
(() => {
    const modalElement = document.getElementById('confirmationModal');
    if (!modalElement) {
        return;
    }

    const modalTitle = document.getElementById('confirmationModalTitle');
    const modalBody = document.getElementById('confirmationModalBody');
    const confirmButton = document.getElementById('confirmButton');
    const modalInstance = new bootstrap.Modal(modalElement);

    let resolver = null;
    let wasConfirmed = false;
    const defaultConfirmClass = 'btn btn-danger';

    confirmButton.addEventListener('click', () => {
        wasConfirmed = true;
        modalInstance.hide();
    });

    modalElement.addEventListener('hidden.bs.modal', () => {
        if (typeof resolver === 'function') {
            resolver(wasConfirmed);
        }
        wasConfirmed = false;
        resolver = null;
        confirmButton.className = defaultConfirmClass;
        confirmButton.textContent = 'Confirm';
    });

    window.showConfirmationModal = function showConfirmationModal({
        title = 'Confirm action',
        message = 'Are you sure you want to continue?',
        confirmLabel = 'Confirm',
        confirmVariant = 'danger',
    } = {}) {
        if (modalTitle) {
            modalTitle.textContent = title;
        }
        if (modalBody) {
            modalBody.textContent = message;
        }
        if (confirmButton) {
            const normalizedVariant = (confirmVariant || 'danger').trim();
            if (normalizedVariant.startsWith('btn')) {
                confirmButton.className = normalizedVariant;
            } else if (normalizedVariant.includes(' ')) {
                confirmButton.className = `btn ${normalizedVariant}`;
            } else {
                confirmButton.className = `btn btn-${normalizedVariant}`;
            }
            confirmButton.textContent = confirmLabel;
        }

        modalInstance.show();
        return new Promise((resolve) => {
            resolver = resolve;
        });
    };
})();
</script>
